---
title: LCFinder 0.10.0 开发日志
ds_thread_key: devlog-lcfinder-0.10.0
---

## 2016-03-01
之前看过 Google Photos 网页上的功能介绍，据说可以自动识别照片内容，例如：狗，搜索“狗”就能搜索到相关图片，要是 LCFinder 能有这个功能的话，就不用靠用户自己根据图像内容特征来添加标签了，OpenCV有相关特征匹配算法，这样只需要保存各种对象的特征数据，然后程序在导入图片时自动匹配特征并添加标签。看上去特征匹配算法会很耗时，假设进行一次特征匹配需要耗时10ms，有32组特征，每组特征里有10种相关特征的数据，需处理5000张图片，那么耗时大约为：`0.01s*32*10*5000 = 16000s ≈ 4.44小时 `，卧槽，这种功能需要单独开来，弄个界面，告诉用户这个功能大约耗时多长，需要用的话就一直开着程序。图像特征库可以导入/到处，这样可以分享给其它用户，省得每个用户都自己积累特征数据。

## 2016-02-28
为文件夹视图添加了文件同步功能，点击同步按钮后，会显示一个提示框，能看到文件扫描数量的变化。
[![](/static/images/devlog/lcfinder-003.png "文件同步提示框")](/static/images/devlog/lcfinder-001.png)

## 2016-02-25
纯文字看的很枯燥，以下是目前的效果图，以后也会陆续贴一些图，可以从这些图中看到LCFinder的各种变化。

[![](/static/images/devlog/lcfinder-001.png "LCFinder 效果图")](/static/images/devlog/lcfinder-001.png)

[![](/static/images/devlog/lcfinder-002.png "LCFinder 效果图")](/static/images/devlog/lcfinder-002.png)

## 2016-02-24
缩略图缓存用 unqlite 数据库来保存，毕竟只需要用文件路径（key）来获取缩略图（value）。`unqlite_open()` 函数的文件路径参数是 char *类型，而从 sqlite 数据库中保存/读取的文件路径是 UTF-8 编码的，不知道非宽字符版的文件操作函数是以何种编码方式处理文件路径，感觉很有可能是 ANSI，那么需要转换编码。

## 2016-02-23
考虑到 LCFinder 浏览的图片数量会很大，那么就得尽量减少内存占用，起码要能应付10000张图片。首先，需要在内存中弄一块缓存区来缓存缩略图，限制最大占用空间，当达到上限时可释放较老的缩略图缓存来腾出空间。除了内存中，在硬盘中也需要保存缩略图，方便以后读取。缩略图与原图需要保持同步，那么就得在缩略图数据中保存原图的修改时间，当修改时间不一致时更新缩略图。其次，用于显示图片的 LCUI 部件需要弄成单缓存模式，不缓存部件位图，减少内存占用。图片不用一次性载入完，可以分批载入，例如：每次载入100张图片，当浏览到最后几张图片时自动载入下100张图片。

单独开了个日志来记录 LCFinder 的开发动态，代码库：https://github.com/lc-soft/LC-Finder 。LCFinder 是一个资源检索与管理工具，类似于 windows 10 系统中的“照片”应用，开发它是为了满足自己的需求，顺便测试和完善 LCUI 的各项功能。
