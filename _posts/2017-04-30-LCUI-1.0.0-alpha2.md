---
title: LCUI 1.0 Alpha 2 开发日志
repo: lc-soft/LCUI
milestone: 3
---
## 2017-05-13
部件的边框、阴影和背景已经做了调整，部件的实际区域可以在绘制时计算，不用缓存。

感觉用 left、top、right、bottom 表示矩形更好些，矩形溢出判断和裁剪操作可以省去 x + width 这样的加法运算。

在设置全局缩放比例后，获取到的屏幕尺寸需要除以缩放比例，鼠标坐标也需要做转换，底层的接口获取到的屏幕尺寸和鼠标坐标保持不变，仅在部件层做转换。

文字的行高需要统一像素值，但 TextLayer 支持设置部分文字的大小，行高固定的话会影响文字显示效果，要么撤销文字大小设置功能？

## 2017-05-09
Widget_InvalidateArea() 看上去可以移除了，没必要让每个部件记录自己的脏矩形，都改用 Widget_PushInvalidArea()，将所有脏矩形都集中放到一个地方，这样一来可以删掉一些代码。

## 2017-05-07
实际值(Actual values)用于最终渲染，主要包括坐标、尺寸、边框、阴影、背景等的值，且都为整数。搞那么多样式，最终的计算结果也就这么几个值。

目前需要解决的问题是边框、阴影、背景的实际值的存放位置，有两个可选方案：

- 现有的结构体。例如背景的结构体是 LCUI_Background，再为它加个 actual 成员来存放计算后的实际值，绘制背景时直接根据 actual 成员里的值进行绘制。这样做的好处是只需要一个结构体，不会有重复的属性，节省内存占用；但坏处是 draw/background.c 会依赖 gui/metrics.c 的实际值计算接口，增加了耦合度。
- 独立的结构体。同样以背景的结构体为例，要么新建个 LCUI_ActualBackground 结构体，要么将现有的 LCUI_Background 重命名为 LCUI_BackgroundStyle，然后新建个 LCUI_Background 结构体，并将它作为 background.c 实际使用的值。LCUI_Background 由 LCUI_BackgroundStyle 计算而来，计算在 widget_background.c 中进行。

## 2017-04-30
新开了一篇文章来记录 1.0 alpha 2 版本的开发日志，以后版本需要更新频繁点，每个版本修复几个 BUG 再添加几个新功能就差不多了。
